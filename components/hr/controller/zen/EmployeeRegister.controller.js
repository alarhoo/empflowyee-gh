sap.ui.define(["../BaseController","com/alarhoo/empflowyee/lib/Utils","sap/ui/model/json/JSONModel","sap/ui/model/SimpleType","sap/ui/model/ValidateException","sap/ui/core/Core","sap/m/MessageBox","sap/m/MessageToast"],function(e,t,o,i,a,n,s,r){"use strict";return e.extend("com.alarhoo.empflowyee.components.hr.controller.zen.EmployeeRegister",{onInit:function(){this._wizard=this.byId("idCreateEmployeeWizard");this._navContainer=this.byId("idEmployeeRegisterNavContainer");this._registerPage=this.byId("idEmployeeRegisterPage");this._reviewPage=this.byId("idEmployeeReviewPage");this._registerModel=new o({EmpMainFirst:"",EmpMainMiddle:"",EmpMainLast:"",EmpMail:"",EmpMainDob:"",EmpMainGender:0,empBloodGroup:"",EmpMainId:"",EmpMainOrgMail:"",EmpMainDoj:"",EmpMainBillable:true,EmpMainContract:false,EmpMainProfile:"BASIC,HR,MANAGER,ADMIN",EmpMainDesignation:"",EmpMainLead:"",EmpMainWorkspace:"India",EmpInfoPriContact:"",EmpInfoSecContact:"",EmpInfoEmgContact:"",EmpInfoEmgName:"",EmpInfoEmgRel:"friends",EmpInfoAddrLoc:"",EmpInfoRegionLoc:"",EmpInfoStateLoc:"",EmpInfoCountryLoc:"",EmpInfoPostLoc:"",EmpInfoAddrSame:false,EmpInfoAddrPerm:"",EmpInfoRegionPerm:"",EmpInfoStatePerm:"",EmpInfoCountryPerm:"",EmpInfoPostPerm:"",EmpIdPAN:"",EmpIdAadhar:"",EmpIdVoter:"",EmpIdDL:"",EmpIdSSN:"",EmpIdPassport:"",EmpIdPassportFirst:"",EmpIdPassportMid:"",EmpIdPassportLast:"",EmpIdPassportDob:"",EmpIdPassportIssueDate:"",EmpIdPassportExpiryDate:"",EmpIdPassportIssuePlace:""});this.getView().setModel(this._registerModel,"register");const e=new o({empPAN:{name:"PAN Card",source:null},empAadhar:{name:"Aadhar Card",source:null},empVoterCard:{name:"Voter ID",source:null},empDrivingLicense:{name:"Driving License",source:null},empPassport:{name:"Passport",source:null},empSSN:{name:"Social Security Number",source:null}});this.getView().setModel(e,"upload");this._uiModel=this.getOwnerComponent().getModel("ui");this.getRouter().getRoute("employeeRegisterRoute").attachPatternMatched(this._onEmployeeRegisterMatched,this);this.getRouter().getRoute("employeeEditRoute").attachPatternMatched(this._onEmployeeEditMatched,this)},_onEmployeeRegisterMatched:function(){this._uiModel.setData({pageTitle:"Register Employee",saveButtonText:"Create",saveButtonType:"Emphasized"})},_onEmployeeEditMatched:function(e){const t=e.getParameter("arguments").employeeId;if(!t){r.show("No employee ID provided for editing.");return}this._uiModel.setData({pageTitle:"Update Employee",saveButtonText:"Update",saveButtonType:"Success"});const o=this.getOwnerComponent().getModel("emp").getData();const i=this.getOwnerComponent().getModel("empInfo").getData();const a=o.find(e=>e.EmpMainId===t);const n=i.find(e=>e.EmpInfoMain===t);if(a&&n){const e={...a,...n};console.log(e);this._registerModel.setData(e);this._wizard.discardProgress(this.byId("PrimaryStep"));this._wizard.goToStep(this.byId("PrimaryStep"));this._navContainer.to(this._registerPage);r.show(`Employee ${t} loaded for editing.`)}else{r.show(`Employee ${t} data not found in either model.`);console.warn(`Employee data not found for ID: ${t}`);this.getRouter().navTo("employeeMasterRoute",{})}},onGenderRadioButtonSelect:function(e){const t=e.getParameter("selectedKey");this._registerModel.setProperty("/EmpMainGender",parseInt(t,10))},onProfileTypeSelect:function(e){try{const t=e.getSource();const o=t.getText().toUpperCase();const i=e.getParameter("selected");const a=this._registerModel.getProperty("/EmpMainProfile")||"";let n=a.split(",").filter(Boolean);if(i&&!n.includes(o)){n.push(o)}else if(!i&&n.includes(o)){n=n.filter(e=>e!==o)}this._registerModel.setProperty("/EmpMainProfile",n.join(","))}catch(e){r.show(e.message);console.error(e)}},isProfileSelected:function(e,t){if(!e||!t||!t.value)return false;return e.split(",").includes(t.value)},onWorkplaceSelect:function(e){const t=e.getSource().getSelectedButton().getText();this._registerModel.setProperty("/EmpMainWorkspace",t)},_validateInput:function(e){let t="None";let o=false;const i=e.getBinding("value");try{i.getType().validateValue(e.getValue())}catch(e){t="Error";o=true;console.error("validation error: "+e.message)}e.setValueState(t);return o},validateValue:function(e){const t=/^\w+[\w-+.]*@utegration.com$/;if(!e.match(t)){throw new a("'"+e+"' is not a valid e-mail address")}},onSubmit:function(){const e=this.getView(),t=[e.byId("nameInput"),e.byId("emailInput")];let o=false;t.forEach(function(e){o=this._validateInput(e)||o},this);if(!o){r.show("The input is validated. Your form has been submitted.")}else{s.alert("A validation error has occurred. Complete your input first.")}},onPrimaryDetailsLiveChange:function(){try{const{EmpMainId:e,EmpMail:o,EmpMainDoj:i,EmpMainFirst:a,EmpMainLast:n,EmpMainDob:s,EmpMainDesignation:r,EmpMainLead:d,EmpInfoPriContact:l,EmpInfoEmgContact:p,EmpInfoEmgName:m}=this._registerModel.getData();if(t.valueExists(e)&&t.valueExists(o)&&t.valueExists(i)&&t.valueExists(a)&&t.valueExists(n)&&t.valueExists(s)&&t.valueExists(r)&&t.valueExists(d)&&t.valueExists(l)&&t.valueExists(p)&&t.valueExists(m)){this._wizard.validateStep(this.byId("PrimaryStep"))}else{this._wizard.invalidateStep(this.byId("PrimaryStep"))}}catch(e){r.show(e.message);console.error(e)}},onSecondaryDetailsLiveChange:function(){try{const{EmpInfoAddrLoc:e,EmpInfoRegionLoc:o,EmpInfoStateLoc:i,EmpInfoCountryLoc:a,EmpInfoPostLoc:n,EmpInfoAddrSame:s}=this._registerModel.getData();if(t.valueExists(e)&&t.valueExists(o)&&t.valueExists(i)&&t.valueExists(a)&&t.valueExists(n)){this._wizard.validateStep(this.byId("SecondaryStep"))}else{this._wizard.invalidateStep(this.byId("SecondaryStep"))}if(s){this._validateSameAsAddress(s)}}catch(e){r.show(e.message);console.error(e)}},onIdentificationDetailsLiveChange:function(){try{const{EmpIdPAN:e,EmpIdAadhar:o}=this._registerModel.getData();if(t.valueExists(e)&&t.valueExists(o)){this._wizard.validateStep(this.byId("IdentificationStep"))}else{this._wizard.invalidateStep(this.byId("IdentificationStep"))}}catch(e){r.show(e.message);console.error(e)}},onCreateEmployeeWizardComplete:function(){this._navContainer.to(this._reviewPage)},_backToWizardContent:function(){this._navContainer.backToPage(this._registerPage.getId())},_handleNavigationToStep:function(e){const t=function(){this._wizard.goToStep(this._wizard.getSteps()[e]);this._navContainer.detachAfterNavigate(t)}.bind(this);this._navContainer.attachAfterNavigate(t);this._backToWizardContent()},editStepOne:function(){this._handleNavigationToStep(0)},editStepTwo:function(){this._handleNavigationToStep(1)},editStepThree:function(){this._handleNavigationToStep(2)},onEmployeeCreateButtonPress:function(){try{const e=this._registerModel.getData();console.log("send data to backend",e)}catch(e){console.log(e);r.show(e.message)}},onReviewPageNavButtonPress:function(){this._navContainer.to(this._registerPage)},onSameAsLocalAddressCheckBoxSelect:function(e){const t=e.getSource().getSelected();this._validateSameAsAddress(t)},_validateSameAsAddress:function(e){const{EmpInfoAddrLoc:t,EmpInfoRegionLoc:o,EmpInfoStateLoc:i,EmpInfoCountryLoc:a,EmpInfoPostLoc:n}=this._registerModel.getData();if(e){this._registerModel.setProperty("/EmpInfoAddrPerm",t);this._registerModel.setProperty("/EmpInfoRegionPerm",o);this._registerModel.setProperty("/EmpInfoStatePerm",i);this._registerModel.setProperty("/EmpInfoCountryPerm",a);this._registerModel.setProperty("/EmpInfoPostPerm",n)}},onFileUploadChange:function(e){const t=e.getParameter("file");if(t){console.log("Received file:",t)}},customEMailType:i.extend("email",{formatValue:function(e){return e},parseValue:function(e){return e},validateValue:function(e){const t=/^\w+[\w-+.]*@utegration.com$/;if(!e.match(t)){throw new a("'"+e+"' is not a valid e-mail address")}}})})});
//# sourceMappingURL=EmployeeRegister.controller.js.map