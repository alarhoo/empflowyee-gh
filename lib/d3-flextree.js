(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports):typeof define==="function"&&define.amd?define(["exports"],t):t(e.d3=e.d3||{})})(this,function(e){"use strict";function t(e){var t=0,r=e.children,n=r&&r.length;if(!n)t=1;else while(--n>=0)t+=r[n].value;e.value=t}function r(){return this.eachAfter(t)}function n(e){var t=this,r,n=[t],i,l,u;do{r=n.reverse(),n=[];while(t=r.pop()){e(t),i=t.children;if(i)for(l=0,u=i.length;l<u;++l){n.push(i[l])}}}while(n.length);return this}function i(e){var t=this,r=[t],n,i;while(t=r.pop()){e(t),n=t.children;if(n)for(i=n.length-1;i>=0;--i){r.push(n[i])}}return this}function l(e){var t=this,r=[t],n=[],i,l,u;while(t=r.pop()){n.push(t),i=t.children;if(i)for(l=0,u=i.length;l<u;++l){r.push(i[l])}}while(t=n.pop()){e(t)}return this}function u(e){return this.eachAfter(function(t){var r=+e(t.data)||0,n=t.children,i=n&&n.length;while(--i>=0)r+=n[i].value;t.value=r})}function o(e){return this.eachBefore(function(t){if(t.children){t.children.sort(e)}})}function a(e){var t=this,r=h(t,e),n=[t];while(t!==r){t=t.parent;n.push(t)}var i=n.length;while(e!==r){n.splice(i,0,e);e=e.parent}return n}function h(e,t){if(e===t)return e;var r=e.ancestors(),n=t.ancestors(),i=null;e=r.pop();t=n.pop();while(e===t){i=e;e=r.pop();t=n.pop()}return i}function c(){var e=this,t=[e];while(e=e.parent){t.push(e)}return t}function s(){var e=[];this.each(function(t){e.push(t)});return e}function f(){var e=[];this.eachBefore(function(t){if(!t.children){e.push(t)}});return e}function d(){var e=this,t=[];e.each(function(r){if(r!==e){t.push({source:r.parent,target:r})}});return t}function p(e,t){var r=new m(e),n=+e.value&&(r.value=e.value),i,l=[r],u,o,a,h;if(t==null)t=g;while(i=l.pop()){if(n)i.value=+i.data.value;if((o=t(i.data))&&(h=o.length)){i.children=new Array(h);for(a=h-1;a>=0;--a){l.push(u=i.children[a]=new m(o[a]));u.parent=i;u.depth=i.depth+1}}}return r.eachBefore(x)}function v(){return p(this).eachBefore(y)}function g(e){return e.children}function y(e){e.data=e.data.data}function x(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function m(e){this.data=e;this.depth=this.height=0;this.parent=null}m.prototype=p.prototype={constructor:m,count:r,each:n,eachAfter:l,eachBefore:i,sum:u,sort:o,path:a,ancestors:c,descendants:s,leaves:f,links:d,copy:v};var b="d3-flextree";var w="2.1.2";var E="build/d3-flextree.js";var X="index";var k={name:"Chris Maloney",url:"http://chrismaloney.org"};var j="Flexible tree layout algorithm that allows for variable node sizes.";var z=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"];var C="https://github.com/klortho/d3-flextree";var S="WTFPL";var O={type:"git",url:"https://github.com/klortho/d3-flextree.git"};var R={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"};var _={"d3-hierarchy":"^1.1.5"};var T={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"};var B={name:b,version:w,main:E,module:X,author:k,description:j,keywords:z,homepage:C,license:S,repository:O,scripts:R,dependencies:_,devDependencies:T,"jsnext:main":"index"};var M=function(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}};var P=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var A=function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t};var D=function(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e};var I=function(){function e(e,t){var r=[];var n=true;var i=false;var l=undefined;try{for(var u=e[Symbol.iterator](),o;!(n=(o=u.next()).done);n=true){r.push(o.value);if(t&&r.length===t)break}}catch(e){i=true;l=e}finally{try{if(!n&&u["return"])u["return"]()}finally{if(i)throw l}}return r}return function(t,r){if(Array.isArray(t)){return t}else if(Symbol.iterator in Object(t)){return e(t,r)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();var L=B.version;var U=Object.freeze({children:function e(t){return t.children},nodeSize:function e(t){return t.data.size},spacing:0});function Y(e){var t=Object.assign({},U,e);function r(e){var r=t[e];return typeof r==="function"?r:function(){return r}}function n(e){var t=u(l(),e,function(e){return e.children});t.update();return t.data}function i(){var e=r("nodeSize");var t=r("spacing");return function(r){A(n,r);function n(e){M(this,n);return D(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e))}P(n,[{key:"copy",value:function e(){var t=u(this.constructor,this,function(e){return e.children});t.each(function(e){return e.data=e.data.data});return t}},{key:"spacing",value:function e(r){return t(this,r)}},{key:"size",get:function t(){return e(this)}},{key:"nodes",get:function e(){return this.descendants()}},{key:"xSize",get:function e(){return this.size[0]}},{key:"ySize",get:function e(){return this.size[1]}},{key:"top",get:function e(){return this.y}},{key:"bottom",get:function e(){return this.y+this.ySize}},{key:"left",get:function e(){return this.x-this.xSize/2}},{key:"right",get:function e(){return this.x+this.xSize/2}},{key:"root",get:function e(){var t=this.ancestors();return t[t.length-1]}},{key:"numChildren",get:function e(){return this.hasChildren?this.children.length:0}},{key:"hasChildren",get:function e(){return!this.noChildren}},{key:"noChildren",get:function e(){return this.children===null}},{key:"firstChild",get:function e(){return this.hasChildren?this.children[0]:null}},{key:"lastChild",get:function e(){return this.hasChildren?this.children[this.numChildren-1]:null}},{key:"extents",get:function e(){return(this.children||[]).reduce(function(e,t){return n.maxExtents(e,t.extents)},this.nodeExtents)}},{key:"nodeExtents",get:function e(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}],[{key:"maxExtents",value:function e(t,r){return{top:Math.min(t.top,r.top),bottom:Math.max(t.bottom,r.bottom),left:Math.min(t.left,r.left),right:Math.max(t.right,r.right)}}}]);return n}(p.prototype.constructor)}function l(){var e=i();var t=r("nodeSize");var n=r("spacing");return function(e){A(r,e);function r(e){M(this,r);var t=D(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));Object.assign(t,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:t,lExtRelX:0,lThr:null,rExt:t,rExtRelX:0,rThr:null});return t}P(r,[{key:"spacing",value:function e(t){return n(this.data,t.data)}},{key:"update",value:function e(){F(this);W(this);return this}},{key:"size",get:function e(){return t(this.data)}},{key:"x",get:function e(){return this.data.x},set:function e(t){this.data.x=t}},{key:"y",get:function e(){return this.data.y},set:function e(t){this.data.y=t}}]);return r}(e)}function u(e,t,r){var n=function t(n,i){var l=new e(n);Object.assign(l,{parent:i,depth:i===null?0:i.depth+1,height:0,length:1});var u=r(n)||[];l.children=u.length===0?null:u.map(function(e){return t(e,l)});if(l.children){Object.assign(l,l.children.reduce(function(e,t){return{height:Math.max(e.height,t.height+1),length:e.length+t.length}},l))}return l};return n(t,null)}Object.assign(n,{nodeSize:function e(r){return arguments.length?(t.nodeSize=r,n):t.nodeSize},spacing:function e(r){return arguments.length?(t.spacing=r,n):t.spacing},children:function e(r){return arguments.length?(t.children=r,n):t.children},hierarchy:function e(r,n){var l=typeof n==="undefined"?t.children:n;return u(i(),r,l)},dump:function e(t){var n=r("nodeSize");var i=function e(t){return function(r){var i=t+"  ";var l=t+"    ";var u=r.x,o=r.y;var a=n(r);var h=r.children||[];var c=h.length===0?" ":","+i+"children: ["+l+h.map(e(l)).join(l)+i+"],"+t;return"{ size: ["+a.join(", ")+"],"+i+"x: "+u+", y: "+o+c+"},"}};return i("\n")(t)}});return n}Y.version=L;var F=function e(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;t.y=r;(t.children||[]).reduce(function(r,n){var i=I(r,2),l=i[0],u=i[1];e(n,t.y+t.ySize);var o=(l===0?n.lExt:n.rExt).bottom;if(l!==0)G(t,l,u);var a=$(o,l,u);return[l+1,a]},[0,null]);q(t);Z(t);return t};var W=function e(t,r,n){if(typeof r==="undefined"){r=-t.relX-t.prelim;n=0}var i=r+t.relX;t.relX=i+t.prelim-n;t.prelim=0;t.x=n+t.relX;(t.children||[]).forEach(function(r){return e(r,i,t.x)});return t};var q=function e(t){(t.children||[]).reduce(function(e,t){var r=I(e,2),n=r[0],i=r[1];var l=n+t.shift;var u=i+l+t.change;t.relX+=u;return[l,u]},[0,0])};var G=function e(t,r,n){var i=t.children[r-1];var l=t.children[r];var u=i;var o=i.relX;var a=l;var h=l.relX;var c=true;while(u&&a){if(u.bottom>n.lowY)n=n.next;var s=o+u.prelim-(h+a.prelim)+u.xSize/2+a.xSize/2+u.spacing(a);if(s>0||s<0&&c){h+=s;H(l,s);J(t,r,n.index,s)}c=false;var f=u.bottom;var d=a.bottom;if(f<=d){u=N(u);if(u)o+=u.relX}if(f>=d){a=K(a);if(a)h+=a.relX}}if(!u&&a)Q(t,r,a,h);else if(u&&!a)V(t,r,u,o)};var H=function e(t,r){t.relX+=r;t.lExtRelX+=r;t.rExtRelX+=r};var J=function e(t,r,n,i){var l=t.children[r];var u=r-n;if(u>1){var o=i/u;t.children[n+1].shift+=o;l.shift-=o;l.change-=i-o}};var K=function e(t){return t.hasChildren?t.firstChild:t.lThr};var N=function e(t){return t.hasChildren?t.lastChild:t.rThr};var Q=function e(t,r,n,i){var l=t.firstChild;var u=l.lExt;var o=t.children[r];u.lThr=n;var a=i-n.relX-l.lExtRelX;u.relX+=a;u.prelim-=a;l.lExt=o.lExt;l.lExtRelX=o.lExtRelX};var V=function e(t,r,n,i){var l=t.children[r];var u=l.rExt;var o=t.children[r-1];u.rThr=n;var a=i-n.relX-l.rExtRelX;u.relX+=a;u.prelim-=a;l.rExt=o.rExt;l.rExtRelX=o.rExtRelX};var Z=function e(t){if(t.hasChildren){var r=t.firstChild;var n=t.lastChild;var i=(r.prelim+r.relX-r.xSize/2+n.relX+n.prelim+n.xSize/2)/2;Object.assign(t,{prelim:i,lExt:r.lExt,lExtRelX:r.lExtRelX,rExt:n.rExt,rExtRelX:n.rExtRelX})}};var $=function e(t,r,n){while(n!==null&&t>=n.lowY){n=n.next}return{lowY:t,index:r,next:n}};e.flextree=Y;Object.defineProperty(e,"__esModule",{value:true})});
//# sourceMappingURL=d3-flextree.js.map