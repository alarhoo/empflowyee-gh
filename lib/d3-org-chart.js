!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-selection"),require("d3-array"),require("d3-hierarchy"),require("d3-zoom"),require("d3-flextree"),require("d3-shape")):"function"==typeof define&&define.amd?define(["exports","d3-selection","d3-array","d3-hierarchy","d3-zoom","d3-flextree","d3-shape"],e):e(t.d3=t.d3||{},t.d3,t.d3,t.d3,t.d3,t.d3,t.d3)}(this,function(t,e,n,a,i,o,r){"use strict";const d={selection:e.selection,select:e.select,max:n.max,min:n.min,sum:n.sum,cumsum:n.cumsum,tree:a.tree,stratify:a.stratify,zoom:i.zoom,zoomIdentity:i.zoomIdentity,linkHorizontal:r.linkHorizontal,flextree:o.flextree};t.OrgChart=class{constructor(){const t={id:"ID"+Math.floor(1e6*Math.random()),firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:t=>t.nodeId||t.id,parentNodeId:t=>t.parentNodeId||t.parentId,rootMargin:40,nodeWidth:t=>250,nodeHeight:t=>150,neighbourMargin:(t,e)=>80,siblingsMargin:t=>20,childrenMargin:t=>60,compactMarginPair:t=>100,compactMarginBetween:t=>20,nodeButtonWidth:t=>40,nodeButtonHeight:t=>40,nodeButtonX:t=>-20,nodeButtonY:t=>-20,linkYOffset:30,pagingStep:t=>5,minPagingVisibleNodes:t=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:t=>d.zoom(),onZoomStart:t=>{},onZoom:t=>{},onZoomEnd:t=>{},onNodeClick:t=>t,onExpandOrCollapse:t=>t,nodeContent:t=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${t.id}), override using <br/> \n            <code>chart.nodeContent({data}=>{ <br/>\n             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>\n             })</code>\n             <br/> \n             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>\n             </div>`,buttonContent:({node:t,state:e})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:e=>e?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>\n                      </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>\n                          </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`,bottom:e=>e?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>\n                       </svg></span><span style="margin-left:1px;color:#716E7B" >${t.data._directSubordinatesPaging} </span></div>\n                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>\n                       </svg></span><span style="margin-left:1px;color:#716E7B" >${t.data._directSubordinatesPaging} </span></div>\n                    `,right:e=>e?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>\n                       </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>\n                       </svg></span><span style="color:#716E7B">${t.data._directSubordinatesPaging} </span></div>`,top:e=>e?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>\n                        </svg></span><span style="margin-left:1px;color:#716E7B">${t.data._directSubordinatesPaging} </span></div>\n                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>\n                        </svg></span><span style="margin-left:1px;color:#716E7B">${t.data._directSubordinatesPaging} </span></div>\n                    `}[e.layout](t.children)}  </div>`,pagingButton:(t,e,n,a)=>{var a=a.pagingStep(t.parent),i=t.parent.data._pagingStep,t=t.parent.data._directSubordinatesPaging-i;return`\n                   <div style="margin-top:90px;">\n                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">\n                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>\n                      </svg>\n                      </div><div style="line-height:2"> Show next ${Math.min(t,a)}  nodes </div></div>\n                   </div>\n                `},nodeUpdate:function(t,e,n){d.select(this).select(".node-rect").attr("stroke",t=>t.data._highlighted||t.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",t.data._highlighted||t.data._upToTheRootHighlighted?10:1)},nodeEnter:t=>t,nodeExit:t=>t,linkUpdate:function(t,e,n){d.select(this).attr("stroke",t=>t.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",t=>t.data._upToTheRootHighlighted?5:1),t.data._upToTheRootHighlighted&&d.select(this).raise()},hdiagonal:function(t,e,n){var a=t.x,t=t.y,i=e.x,e=e.y,o=n&&null!=n.x?n.x:a,n=n&&null!=n.y?n.y:t,r=i-a<0?-1:1,d=e-t<0?-1:1,s=Math.abs(i-a)/2<35?Math.abs(i-a)/2:35,s=Math.abs(e-t)/2<s?Math.abs(e-t)/2:s,l=(Math.abs(e-t),Math.abs(i-a)/2-s);return`\n                          M ${o} ${n}\n                          L ${o} ${t}\n                          L ${a} ${t}\n                          L ${a+l*r} ${t}\n                          C ${a+l*r+s*r} ${t} \n                            ${a+l*r+s*r} ${t} \n                            ${a+l*r+s*r} ${t+s*d}\n                          L ${a+l*r+s*r} ${e-s*d} \n                          C ${a+l*r+s*r}  ${e} \n                            ${a+l*r+s*r}  ${e} \n                            ${i-l*r}  ${e}\n                          L ${i} ${e}\n               `},diagonal:function(t,e,n,a={sy:0}){var i=t.x,t=t.y,o=e.x,e=e.y,r=n&&null!=n.x?n.x:i,n=n&&null!=n.y?n.y:t,d=o-i<0?-1:1,s=e-t<0?-1:1,a=(t+=a.sy,Math.abs(o-i)/2<35?Math.abs(o-i)/2:35),a=Math.abs(e-t)/2<a?Math.abs(e-t)/2:a,l=Math.abs(e-t)/2-a;return`\n                          M ${r} ${n}\n                          L ${i} ${n}\n                          L ${i} ${t}\n                          L ${i} ${t+l*s}\n                          C  ${i} ${t+l*s+a*s} ${i} ${t+l*s+a*s} ${i+a*d} ${t+l*s+a*s}\n                          L ${i+(Math.abs(o-i)-2*a)*d+a*d} ${t+l*s+a*s}\n                          C  ${o}  ${t+l*s+a*s} ${o}  ${t+l*s+a*s} ${o} ${e-l*s}\n                          L ${o} ${e}\n               `},defs:function(t,e){return`<defs>\n                    ${e.map(e=>{var n=this.getTextWidth(e.label,{ctx:t.ctx,fontSize:2,defaultFont:t.defaultFont});return`\n                       <marker id="${e.from+"_"+e.to}" refX="${e._source.x<e._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${e._source.x<e._target.x?"auto":"auto-start-reverse"}" >\n                       <rect rx=0.5 width=${e.label?n+3:0} height=3 y=1  fill="#E27396"></rect>\n                       <text font-size="2px" x=1 fill="white" y=3>${e.label||""}</text>\n                       </marker>\n\n                       <marker id="arrow-${e.from+"_"+e.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${e._source.x<e._target.x?"auto":"auto-start-reverse"}" >\n                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />\n                       </marker>\n                    `}).join("")}\n                    </defs>\n                    `},connectionsUpdate:function(t,e,n){d.select(this).attr("stroke",t=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",t=>"5").attr("pointer-events","none").attr("marker-start",t=>`url(#${t.from+"_"+t.to})`).attr("marker-end",t=>`url(#arrow-${t.from+"_"+t.to})`)},linkGroupArc:d.linkHorizontal().x(t=>t.x).y(t=>t.y),layoutBindings:{left:{nodeLeftX:t=>0,nodeRightX:t=>t.width,nodeTopY:t=>-t.height/2,nodeBottomY:t=>t.height/2,nodeJoinX:t=>t.x+t.width,nodeJoinY:t=>t.y-t.height/2,linkJoinX:t=>t.x+t.width,linkJoinY:t=>t.y,linkX:t=>t.x,linkY:t=>t.y,linkCompactXStart:t=>t.x+t.width/2,linkCompactYStart:t=>t.y+(t.compactEven?t.height/2:-t.height/2),compactLinkMidX:(t,e)=>t.firstCompactNode.x,compactLinkMidY:(t,e)=>t.firstCompactNode.y+t.firstCompactNode.flexCompactDim[0]/4+e.compactMarginPair(t)/4,linkParentX:t=>t.parent.x+t.parent.width,linkParentY:t=>t.parent.y,buttonX:t=>t.width,buttonY:t=>t.height/2,centerTransform:({rootMargin:t,centerY:e,scale:n})=>`translate(${t},${e}) scale(${n})`,compactDimension:{sizeColumn:t=>t.height,sizeRow:t=>t.width,reverse:t=>t.slice().reverse()},nodeFlexSize:({height:t,width:e,siblingsMargin:n,childrenMargin:a,state:i,node:o})=>i.compact&&o.flexCompactDim?[o.flexCompactDim[0],o.flexCompactDim[1]]:[t+n,e+a],zoomTransform:({centerY:t,scale:e})=>`translate(0,${t}) scale(${e})`,diagonal:this.hdiagonal.bind(this),swap:t=>{var e=t.x;t.x=t.y,t.y=e},nodeUpdateTransform:({x:t,y:e,height:n})=>`translate(${t},${e-n/2})`},top:{nodeLeftX:t=>-t.width/2,nodeRightX:t=>t.width/2,nodeTopY:t=>0,nodeBottomY:t=>t.height,nodeJoinX:t=>t.x-t.width/2,nodeJoinY:t=>t.y+t.height,linkJoinX:t=>t.x,linkJoinY:t=>t.y+t.height,linkCompactXStart:t=>t.x+(t.compactEven?t.width/2:-t.width/2),linkCompactYStart:t=>t.y+t.height/2,compactLinkMidX:(t,e)=>t.firstCompactNode.x+t.firstCompactNode.flexCompactDim[0]/4+e.compactMarginPair(t)/4,compactLinkMidY:t=>t.firstCompactNode.y,compactDimension:{sizeColumn:t=>t.width,sizeRow:t=>t.height,reverse:t=>t},linkX:t=>t.x,linkY:t=>t.y,linkParentX:t=>t.parent.x,linkParentY:t=>t.parent.y+t.parent.height,buttonX:t=>t.width/2,buttonY:t=>t.height,centerTransform:({rootMargin:t,scale:e,centerX:n})=>`translate(${n},${t}) scale(${e})`,nodeFlexSize:({height:t,width:e,siblingsMargin:n,childrenMargin:a,state:i,node:o})=>i.compact&&o.flexCompactDim?[o.flexCompactDim[0],o.flexCompactDim[1]]:[e+n,t+a],zoomTransform:({centerX:t,scale:e})=>`translate(${t},0}) scale(${e})`,diagonal:this.diagonal.bind(this),swap:t=>{},nodeUpdateTransform:({x:t,y:e,width:n})=>`translate(${t-n/2},${e})`},bottom:{nodeLeftX:t=>-t.width/2,nodeRightX:t=>t.width/2,nodeTopY:t=>-t.height,nodeBottomY:t=>0,nodeJoinX:t=>t.x-t.width/2,nodeJoinY:t=>t.y-t.height-t.height,linkJoinX:t=>t.x,linkJoinY:t=>t.y-t.height,linkCompactXStart:t=>t.x+(t.compactEven?t.width/2:-t.width/2),linkCompactYStart:t=>t.y-t.height/2,compactLinkMidX:(t,e)=>t.firstCompactNode.x+t.firstCompactNode.flexCompactDim[0]/4+e.compactMarginPair(t)/4,compactLinkMidY:t=>t.firstCompactNode.y,linkX:t=>t.x,linkY:t=>t.y,compactDimension:{sizeColumn:t=>t.width,sizeRow:t=>t.height,reverse:t=>t},linkParentX:t=>t.parent.x,linkParentY:t=>t.parent.y-t.parent.height,buttonX:t=>t.width/2,buttonY:t=>0,centerTransform:({rootMargin:t,scale:e,centerX:n,chartHeight:a})=>`translate(${n},${a-t}) scale(${e})`,nodeFlexSize:({height:t,width:e,siblingsMargin:n,childrenMargin:a,state:i,node:o})=>i.compact&&o.flexCompactDim?[o.flexCompactDim[0],o.flexCompactDim[1]]:[e+n,t+a],zoomTransform:({centerX:t,scale:e})=>`translate(${t},0}) scale(${e})`,diagonal:this.diagonal.bind(this),swap:t=>{t.y=-t.y},nodeUpdateTransform:({x:t,y:e,width:n,height:a})=>`translate(${t-n/2},${e-a})`},right:{nodeLeftX:t=>-t.width,nodeRightX:t=>0,nodeTopY:t=>-t.height/2,nodeBottomY:t=>t.height/2,nodeJoinX:t=>t.x-t.width-t.width,nodeJoinY:t=>t.y-t.height/2,linkJoinX:t=>t.x-t.width,linkJoinY:t=>t.y,linkX:t=>t.x,linkY:t=>t.y,linkParentX:t=>t.parent.x-t.parent.width,linkParentY:t=>t.parent.y,buttonX:t=>0,buttonY:t=>t.height/2,linkCompactXStart:t=>t.x-t.width/2,linkCompactYStart:t=>t.y+(t.compactEven?t.height/2:-t.height/2),compactLinkMidX:(t,e)=>t.firstCompactNode.x,compactLinkMidY:(t,e)=>t.firstCompactNode.y+t.firstCompactNode.flexCompactDim[0]/4+e.compactMarginPair(t)/4,centerTransform:({rootMargin:t,centerY:e,scale:n,chartWidth:a})=>`translate(${a-t},${e}) scale(${n})`,nodeFlexSize:({height:t,width:e,siblingsMargin:n,childrenMargin:a,state:i,node:o})=>i.compact&&o.flexCompactDim?[o.flexCompactDim[0],o.flexCompactDim[1]]:[t+n,e+a],compactDimension:{sizeColumn:t=>t.height,sizeRow:t=>t.width,reverse:t=>t.slice().reverse()},zoomTransform:({centerY:t,scale:e})=>`translate(0,${t}) scale(${e})`,diagonal:this.hdiagonal.bind(this),swap:t=>{var e=t.x;t.x=-t.y,t.y=e},nodeUpdateTransform:({x:t,y:e,width:n,height:a})=>`translate(${t-n},${e-a/2})`}}};this.getChartState=()=>t,Object.keys(t).forEach(e=>{this[e]=function(n){return arguments.length?(t[e]=n,this):t[e]}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){d.selection.prototype.patternify=function(t){var e=t.selector,n=t.tag,t=t.data||[e],t=this.selectAll("."+e).data(t,(t,e)=>"object"==typeof t&&t.id?t.id:e);return t.exit().remove(),(t=t.enter().append(n).merge(t)).attr("class",e),t}}getNodeChildren({data:t,children:e,_children:n},a){return a.push(t),e&&e.forEach(t=>{this.getNodeChildren(t,a)}),n&&n.forEach(t=>{this.getNodeChildren(t,a)}),a}initialZoom(t){return this.getChartState().lastTransform.k=t,this}render(){const t=this.getChartState();if(t.data&&0!=t.data.length){var n=d.select(t.container),a=n.node().getBoundingClientRect();0<a.width&&(t.svgWidth=a.width);const e={id:"ID"+Math.floor(1e6*Math.random()),chartWidth:t.svgWidth,chartHeight:t.svgHeight};(t.calc=e).centerX=e.chartWidth/2,e.centerY=e.chartHeight/2,t.firstDraw&&((a={zoom:null}).zoom=t.createZoom().clickDistance(10).on("start",(e,n)=>t.onZoomStart(e)).on("end",(e,n)=>t.onZoomEnd(e)).on("zoom",(e,n)=>{t.onZoom(e),this.zoomed(e,n)}).scaleExtent(t.scaleExtent),t.zoomBehavior=a.zoom),t.flexTreeLayout=o.flextree({nodeSize:e=>{var n=t.nodeWidth(e),a=t.nodeHeight(e),i=t.siblingsMargin(e),o=t.childrenMargin(e);return t.layoutBindings[t.layout].nodeFlexSize({state:t,node:e,width:n,height:a,siblingsMargin:i,childrenMargin:o})}}).spacing((e,n)=>e.parent==n.parent?0:t.neighbourMargin(e,n)),this.setLayouts({expandNodesFirst:!1});a=n.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",t.svgWidth).attr("height",t.svgHeight).attr("font-family",t.defaultFont),n=(t.firstDraw&&a.call(t.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),(t.svg=a).patternify({tag:"g",selector:"chart"}));t.centerG=n.patternify({tag:"g",selector:"center-group"}),t.linksWrapper=t.centerG.patternify({tag:"g",selector:"links-wrapper"}),t.nodesWrapper=t.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),t.connectionsWrapper=t.centerG.patternify({tag:"g",selector:"connections-wrapper"}),t.defsWrapper=a.patternify({tag:"g",selector:"defs-wrapper"}),t.firstDraw&&t.centerG.attr("transform",()=>t.layoutBindings[t.layout].centerTransform({centerX:e.centerX,centerY:e.centerY,scale:t.lastTransform.k,rootMargin:t.rootMargin,root:t.root,chartHeight:e.chartHeight,chartWidth:e.chartWidth})),t.chart=n,this.update(t.root),d.select(window).on("resize."+t.id,()=>{var e=d.select(t.container).node().getBoundingClientRect();t.svg.attr("width",e.width)}),t.firstDraw&&(t.firstDraw=!1)}else console.log("ORG CHART - Data is empty"),t.container&&(e.select(t.container).select(".nodes-wrapper").remove(),e.select(t.container).select(".links-wrapper").remove(),e.select(t.container).select(".connections-wrapper").remove());return this}addNode(t){const e=this.getChartState();var n,a;return!t||null!=e.parentNodeId(t)&&e.parentNodeId(t)!=e.nodeId(t)||0!=e.data.length?(a=(n=e.generateRoot(e.data).descendants()).filter(({data:n})=>e.nodeId(n).toString()===e.nodeId(t).toString())[0],n.filter(({data:n})=>e.nodeId(n).toString()===e.parentNodeId(t).toString())[0],a?console.log(`ORG CHART - ADD - Node with id "${e.nodeId(t)}" already exists in tree`):(t._centered&&!t._expanded&&(t._expanded=!0),e.data.push(t),this.updateNodesState())):(e.data.push(t),this.render()),this}removeNode(t){const e=this.getChartState();var n=e.generateRoot(e.data).descendants().filter(({data:n})=>e.nodeId(n)==t)[0];return n?(n.descendants().forEach(t=>t.data._filteredOut=!0),e.data=e.data.filter(t=>!t._filteredOut),0==e.data.length?this.render():this.updateNodesState.bind(this)()):console.log(`ORG CHART - REMOVE - Node with id "${t}" not found in the tree`),this}groupBy(t,e,n){const a={};return t.forEach(t=>{var n=e(t);a[n]||(a[n]=[]),a[n].push(t)}),Object.keys(a).forEach(t=>{a[t]=n(a[t])}),Object.entries(a)}calculateCompactFlexDimensions(t){const e=this.getChartState();t.eachBefore(t=>{t.firstCompact=null,t.compactEven=null,t.flexCompactDim=null,t.firstCompactNode=null}),t.eachBefore(t=>{if(t.children&&1<t.children.length){const i=t.children.filter(t=>!t.children);if(!(i.length<2)){i.forEach((t,e)=>{e||(t.firstCompact=!0),t.compactEven=!(e%2),t.row=Math.floor(e/2)});var n=d.max(i.filter(t=>t.compactEven),e.layoutBindings[e.layout].compactDimension.sizeColumn),a=d.max(i.filter(t=>!t.compactEven),e.layoutBindings[e.layout].compactDimension.sizeColumn);const o=2*Math.max(n,a);n=this.groupBy(i,t=>t.row,t=>d.max(t,t=>e.layoutBindings[e.layout].compactDimension.sizeRow(t)+e.compactMarginBetween(t)));const r=d.sum(n.map(t=>t[1]));i.forEach(t=>{t.firstCompactNode=i[0],t.firstCompact?t.flexCompactDim=[o+e.compactMarginPair(t),r-e.compactMarginBetween(t)]:t.flexCompactDim=[0,0]}),t.flexCompactDim=null}}})}calculateCompactFlexPositions(t){const e=this.getChartState();t.eachBefore(t=>{if(t.children){var n=t.children.filter(t=>t.flexCompactDim);const i=n[0];if(i){n.forEach((t,n,a)=>{0==n&&(i.x-=i.flexCompactDim[0]/2),n&n%2-1?t.x=i.x+.25*i.flexCompactDim[0]-e.compactMarginPair(t)/4:n&&(t.x=i.x+.75*i.flexCompactDim[0]+e.compactMarginPair(t)/4)});var a=i.x+.5*i.flexCompactDim[0];i.x=i.x+.25*i.flexCompactDim[0]-e.compactMarginPair(i)/4;const o=t.x-a;Math.abs(o)<10&&n.forEach(t=>t.x+=o);t=this.groupBy(n,t=>t.row,t=>d.max(t,t=>e.layoutBindings[e.layout].compactDimension.sizeRow(t)));const r=d.cumsum(t.map(t=>t[1]+e.compactMarginBetween(t)));n.forEach((t,e)=>{t.row?t.y=i.y+r[t.row-1]:t.y=i.y})}}})}update({x0:t,y0:e,x:n=0,y:a=0,width:i,height:o}){const r=this.getChartState();r.calc;r.compact&&this.calculateCompactFlexDimensions(r.root);var s=r.flexTreeLayout(r.root),l=(r.compact&&this.calculateCompactFlexPositions(r.root),s.descendants()),s=s.descendants().slice(1),h=(l.forEach(r.layoutBindings[r.layout].swap),r.connections);const c={},g=(r.allNodes.forEach(t=>c[r.nodeId(t.data)]=t),{});l.forEach(t=>g[r.nodeId(t.data)]=t),h.forEach(t=>{var e=c[t.from],n=c[t.to];t._source=e,t._target=n});var h=h.filter(t=>g[t.from]&&g[t.to]),p=r.defs.bind(this)(r,h),p=(p!==r.defsWrapper.html()&&r.defsWrapper.html(p),r.linksWrapper.selectAll("path.link").data(s,t=>r.nodeId(t.data))),s=p.enter().insert("path","g").attr("class","link").attr("d",n=>{var a={x:r.layoutBindings[r.layout].linkJoinX({x:t,y:e,width:i,height:o}),y:r.layoutBindings[r.layout].linkJoinY({x:t,y:e,width:i,height:o})};return r.layoutBindings[r.layout].diagonal(a,a,a)}).merge(p),s=(s.attr("fill","none"),this.isEdge()?s.style("display",t=>t.data._pagingButton?"none":"auto"):s.attr("display",t=>t.data._pagingButton?"none":"auto"),s.each(r.linkUpdate),s.transition().duration(r.duration).attr("d",t=>{var e=r.compact&&t.flexCompactDim?{x:r.layoutBindings[r.layout].compactLinkMidX(t,r),y:r.layoutBindings[r.layout].compactLinkMidY(t,r)}:{x:r.layoutBindings[r.layout].linkX(t),y:r.layoutBindings[r.layout].linkY(t)},n={x:r.layoutBindings[r.layout].linkParentX(t),y:r.layoutBindings[r.layout].linkParentY(t)},t=r.compact&&t.flexCompactDim?{x:r.layoutBindings[r.layout].linkCompactXStart(t),y:r.layoutBindings[r.layout].linkCompactYStart(t)}:e;return r.layoutBindings[r.layout].diagonal(e,n,t,{sy:r.linkYOffset})}),p.exit().transition().duration(r.duration).attr("d",t=>{var e={x:r.layoutBindings[r.layout].linkJoinX({x:n,y:a,width:i,height:o}),y:r.layoutBindings[r.layout].linkJoinY({x:n,y:a,width:i,height:o})};return r.layoutBindings[r.layout].diagonal(e,e,null,{sy:r.linkYOffset})}).remove(),r.connectionsWrapper.selectAll("path.connection").data(h)),p=s.enter().insert("path","g").attr("class","connection").attr("d",n=>{var a={x:r.layoutBindings[r.layout].linkJoinX({x:t,y:e,width:i,height:o}),y:r.layoutBindings[r.layout].linkJoinY({x:t,y:e,width:i,height:o})};return r.layoutBindings[r.layout].diagonal(a,a,null,{sy:r.linkYOffset})}).merge(s),h=(p.attr("fill","none"),p.transition().duration(r.duration).attr("d",t=>{var e=r.layoutBindings[r.layout].linkX({x:t._source.x,y:t._source.y,width:t._source.width,height:t._source.height}),n=r.layoutBindings[r.layout].linkY({x:t._source.x,y:t._source.y,width:t._source.width,height:t._source.height}),a=r.layoutBindings[r.layout].linkJoinX({x:t._target.x,y:t._target.y,width:t._target.width,height:t._target.height}),t=r.layoutBindings[r.layout].linkJoinY({x:t._target.x,y:t._target.y,width:t._target.width,height:t._target.height});return r.linkGroupArc({source:{x:e,y:n},target:{x:a,y:t}})}),p.each(r.connectionsUpdate),s.exit().transition().duration(r.duration).attr("opacity",0).remove(),r.nodesWrapper.selectAll("g.node").data(l,({data:t})=>r.nodeId(t))),p=h.enter().append("g").attr("class","node").attr("transform",n=>n==r.root?`translate(${t},${e})`:`translate(${r.layoutBindings[r.layout].nodeJoinX({x:t,y:e,width:i,height:o})},${r.layoutBindings[r.layout].nodeJoinY({x:t,y:e,width:i,height:o})})`).attr("cursor","pointer").on("click.node",(t,e)=>{var n=e["data"];[...t.srcElement.classList].includes("node-button-foreign-object")||([...t.srcElement.classList].includes("paging-button-wrapper")?this.loadPagingNodes(e):n._pagingButton?console.log("event fired, no handlers"):r.onNodeClick(e))}).on("keydown.node",(t,e)=>{var{}=e;"Enter"!==t.key&&" "!==t.key&&"Spacebar"!==t.key||[...t.srcElement.classList].includes("node-button-foreign-object")||([...t.srcElement.classList].includes("paging-button-wrapper")?this.loadPagingNodes(e):"Enter"!==t.key&&" "!==t.key&&"Spacebar"!==t.key||this.onButtonClick(t,e))}),s=(p.each(r.nodeEnter),p.patternify({tag:"rect",selector:"node-rect",data:t=>[t]}),p.merge(h).style("font","12px sans-serif")),p=(s.patternify({tag:"foreignObject",selector:"node-foreign-object",data:t=>[t]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:t=>[t]}),this.restyleForeignObjectElements(),p.patternify({tag:"g",selector:"node-button-g",data:t=>[t]}).on("click",(t,e)=>this.onButtonClick(t,e)).on("keydown",(t,e)=>{"Enter"!==t.key&&" "!==t.key&&"Spacebar"!==t.key||this.onButtonClick(t,e)})),p=(p.patternify({tag:"rect",selector:"node-button-rect",data:t=>[t]}).attr("opacity",0).attr("pointer-events","all").attr("width",t=>r.nodeButtonWidth(t)).attr("height",t=>r.nodeButtonHeight(t)).attr("x",t=>r.nodeButtonX(t)).attr("y",t=>r.nodeButtonY(t)),p.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:t=>[t]}).attr("width",t=>r.nodeButtonWidth(t)).attr("height",t=>r.nodeButtonHeight(t)).attr("x",t=>r.nodeButtonX(t)).attr("y",t=>r.nodeButtonY(t)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:t=>[t]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%"),s.transition().attr("opacity",0).duration(r.duration).attr("transform",({x:t,y:e,width:n,height:a})=>r.layoutBindings[r.layout].nodeUpdateTransform({x:t,y:e,width:n,height:a})).attr("opacity",1),s.select(".node-rect").attr("width",({width:t})=>t).attr("height",({height:t})=>t).attr("x",({})=>0).attr("y",({})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",r.nodeDefaultBackground),s.select(".node-button-g").attr("transform",({width:t,height:e})=>`translate(${r.layoutBindings[r.layout].buttonX({width:t,height:e})},${r.layoutBindings[r.layout].buttonY({width:t,height:e})})`).attr("display",({data:t})=>0<t._directSubordinates?null:"none").attr("opacity",({data:t,children:e,_children:n})=>!t._pagingButton&&(e||n)?1:0),s.select(".node-button-foreign-object .node-button-div").html(t=>r.buttonContent({node:t,state:r})),s.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:t})=>t?40:26).text(({children:t})=>t?"-":"+").attr("y",this.isEdge()?10:0),s.each(r.nodeUpdate),h.exit());p.each(r.nodeExit);const u=p.data().reduce((t,e)=>t.depth<e.depth?t:e,{depth:1/0});p.attr("opacity",1).transition().duration(r.duration).attr("transform",t=>{var{x:e,y:n,width:a,height:i}=u.parent||{};return`translate(${r.layoutBindings[r.layout].nodeJoinX({x:e,y:n,width:a,height:i})},${r.layoutBindings[r.layout].nodeJoinY({x:e,y:n,width:a,height:i})})`}).on("end",function(){d.select(this).remove()}).attr("opacity",0),l.forEach(t=>{t.x0=t.x,t.y0=t.y});s=r.allNodes.filter(t=>t.data._centered)[0];if(s){let t=[s];s.data._centeredWithDescendants&&(t=r.compact?s.descendants().filter((t,e)=>e<7):s.descendants().filter((t,e,n)=>{var a=Math.round(n.length/2);return n.length%2?a-2<e&&e<a+2-1:a-2<e&&e<a+2})),s.data._centeredWithDescendants=null,s.data._centered=null,this.fit({animate:!0,scale:!1,nodes:t})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(t,e,n,a){return this.getChartState().hdiagonal(t,e,n,a)}diagonal(t,e,n,a){return this.getChartState().diagonal(t,e,n,a)}restyleForeignObjectElements(){const t=this.getChartState();t.svg.selectAll(".node-foreign-object").attr("width",({width:t})=>t).attr("height",({height:t})=>t).attr("x",({})=>0).attr("y",({})=>0),t.svg.selectAll(".node-foreign-object-div").style("width",({width:t})=>t+"px").style("height",({height:t})=>t+"px").html(function(e,n,a){return e.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${t.pagingButton(e,n,a,t)}</div></div>`:t.nodeContent.bind(this)(e,n,a,t)})}onButtonClick(t,e){var n=this.getChartState();e.data._pagingButton||(n.setActiveNodeCentered&&(e.data._centered=!0,e.data._centeredWithDescendants=!0),e.children?(e._children=e.children,e.children=null,this.setExpansionFlagToChildren(e,!1)):(e.children=e._children,e._children=null,e.children&&e.children.forEach(({data:t})=>t._expanded=!0)),this.update(e),t.stopPropagation(),n.onExpandOrCollapse(e))}setExpansionFlagToChildren({data:t,children:e,_children:n},a){t._expanded=a,e&&e.forEach(t=>{this.setExpansionFlagToChildren(t,a)}),n&&n.forEach(t=>{this.setExpansionFlagToChildren(t,a)})}expandSomeNodes(t){if(t.data._expanded){let e=t.parent;for(;e&&e._children;)e.children=e._children,e._children=null,e=e.parent}t._children&&t._children.forEach(t=>this.expandSomeNodes(t)),t.children&&t.children.forEach(t=>this.expandSomeNodes(t))}updateNodesState(){var t=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(t.root)}setLayouts({expandNodesFirst:t=!0}){const e=this.getChartState();e.generateRoot=d.stratify().id(t=>e.nodeId(t)).parentId(t=>e.parentNodeId(t)),e.root=e.generateRoot(e.data);var n=e.root.descendants();1<e.initialExpandLevel&&0<n.length&&(n.forEach(t=>{t.depth<=e.initialExpandLevel&&(t.data._expanded=!0)}),e.initialExpandLevel=1);const a={};e.root.descendants().filter(t=>t.children).filter(t=>!t.data._pagingStep).forEach(t=>{t.data._pagingStep=e.minPagingVisibleNodes(t)}),e.root.eachBefore((t,e)=>{t.data._directSubordinatesPaging=t.children?t.children.length:0,t.children&&t.children.forEach((e,n)=>{if(e.data._pagingButton=!1,n>t.data._pagingStep&&(a[e.id]=!0),n===t.data._pagingStep&&t.children.length-1>t.data._pagingStep&&(e.data._pagingButton=!0),a[e.parent.id]&&(a[e.id]=!0),e.data._expanded||e.data._centered||e.data._highlighted||e.data._upToTheRootHighlighted){let t=e;for(;t&&(a[t.id]||t.data._pagingButton);)a[t.id]=!1,t.data._pagingButton&&(t.data._pagingButton=!1,t.parent.children.forEach(t=>{t.data._expanded=!0,a[t.id]=!1})),t=t.parent}})}),e.root=d.stratify().id(t=>e.nodeId(t)).parentId(t=>e.parentNodeId(t))(e.data.filter(t=>!0!==a[t.id])),e.root.each((t,n,a)=>{var i=t._hierarchyHeight||t.height,o=e.nodeWidth(t),r=e.nodeHeight(t);Object.assign(t,{width:o,height:r,_hierarchyHeight:i})}),e.root.x0=0,e.root.y0=0,e.allNodes=e.root.descendants(),e.allNodes.forEach(t=>{Object.assign(t.data,{_directSubordinates:t.children?t.children.length:0,_totalSubordinates:t.descendants().length-1})}),e.root.children&&(t&&e.root.children.forEach(this.expand),e.root.children.forEach(t=>this.collapse(t)),0==e.initialExpandLevel&&(e.root._children=e.root.children,e.root.children=null),[e.root].forEach(t=>this.expandSomeNodes(t)))}collapse(t){t.children&&(t._children=t.children,t._children.forEach(t=>this.collapse(t)),t.children=null)}expand(t){t._children&&(t.children=t._children,t.children.forEach(t=>this.expand(t)),t._children=null)}zoomed(t,e){var n=this.getChartState(),a=n.chart,t=t.transform;n.lastTransform=t,a.attr("transform",t),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:t,x1:e,y0:n,y1:a,params:i={animate:!0,scale:!0,onCompleted:()=>{}}}){var{centerG:o,svgWidth:r,svgHeight:s,svg:l,zoomBehavior:h,duration:c,lastTransform:g}=this.getChartState(),p=Math.min(8,.9/Math.max((e-t)/r,(a-n)/s));let u=d.zoomIdentity.translate(r/2,s/2);u=(u=u.scale(i.scale?p:g.k)).translate(-(t+e)/2,-(n+a)/2),l.transition().duration(i.animate?c:0).call(h.transform,u),o.transition().duration(i.animate?c:0).attr("transform","translate(0,0)").on("end",function(){i.onCompleted&&i.onCompleted()})}fit({animate:t=!0,nodes:e,scale:n=!0,onCompleted:a=()=>{}}={}){const i=this.getChartState();var o=i["root"],e=e||o.descendants(),o=d.min(e,t=>t.x+i.layoutBindings[i.layout].nodeLeftX(t)),r=d.max(e,t=>t.x+i.layoutBindings[i.layout].nodeRightX(t)),s=d.min(e,t=>t.y+i.layoutBindings[i.layout].nodeTopY(t)),e=d.max(e,t=>t.y+i.layoutBindings[i.layout].nodeBottomY(t));return this.zoomTreeBounds({params:{animate:t,scale:n,onCompleted:a},x0:o-50,x1:r+50,y0:s-50,y1:e+50}),this}loadPagingNodes(t){var e=this.getChartState(),n=(t.data._pagingButton=!1,t.parent.data._pagingStep),e=e.pagingStep(t.parent);t.parent.data._pagingStep=n+e,this.updateNodesState()}setExpanded(t,e=!0){const n=this.getChartState();var a=n.allNodes.filter(({data:e})=>n.nodeId(e)==t)[0];if(a){if(0==(a.data._expanded=e)){const t=a.parent||{descendants:()=>[]};t.descendants().filter(e=>e!=t).forEach(t=>t.data._expanded=!1)}}else console.log(`ORG CHART - ${e?"EXPAND":"COLLAPSE"} - Node with id (${t})  not found in the tree`);return this}setCentered(t){const e=this.getChartState();var n=e.generateRoot(e.data).descendants().filter(({data:n})=>e.nodeId(n).toString()==t.toString())[0];return n?(n.ancestors().forEach(t=>t.data._expanded=!0),n.data._centered=!0,n.data._expanded=!0):console.log(`ORG CHART - CENTER - Node with id (${t}) not found in the tree`),this}setHighlighted(t){const e=this.getChartState();var n=e.generateRoot(e.data).descendants().filter(n=>e.nodeId(n.data).toString()===t.toString())[0];return n?(n.ancestors().forEach(t=>t.data._expanded=!0),n.data._highlighted=!0,n.data._expanded=!0,n.data._centered=!0):console.log(`ORG CHART - HIGHLIGHT - Node with id (${t})  not found in the tree`),this}setUpToTheRootHighlighted(t){const e=this.getChartState();var n=e.generateRoot(e.data).descendants().filter(n=>e.nodeId(n.data).toString()===t.toString())[0];return n?(n.ancestors().forEach(t=>t.data._expanded=!0),n.data._upToTheRootHighlighted=!0,n.data._expanded=!0,n.ancestors().forEach(t=>t.data._upToTheRootHighlighted=!0)):console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${t}) not found in the tree`),this}clearHighlighting(){var t=this.getChartState();return t.allNodes.forEach(t=>{t.data._highlighted=!1,t.data._upToTheRootHighlighted=!1}),this.update(t.root),this}fullscreen(t){const e=this.getChartState(),n=d.select(t||e.container).node();d.select(document).on("fullscreenchange."+e.id,function(t){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==n?setTimeout(t=>{e.svg.attr("height",window.innerHeight-40)},500):e.svg.attr("height",e.svgHeight)}),n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen()}zoomIn(){var{svg:t,zoomBehavior:e}=this.getChartState();t.transition().call(e.scaleBy,1.3)}zoomOut(){var{svg:t,zoomBehavior:e}=this.getChartState();t.transition().call(e.scaleBy,.78)}toDataURL(t,e){var n=new XMLHttpRequest;n.onload=function(){var t=new FileReader;t.onloadend=function(){e(t.result)},t.readAsDataURL(n.response)},n.open("GET",t),n.responseType="blob",n.send()}exportImg({full:t=!1,scale:e=3,onLoad:n=t=>t,save:a=!0,backgroundColor:i="#FAFAFA"}={}){const o=this,r=this.getChartState(),{svg:d,root:s}=r;let l=0;var h=d.selectAll("img");let c=h.size();const g=()=>{JSON.parse(JSON.stringify(o.lastTransform()));var d=o.duration();t&&o.fit();const l=o.getChartState()["svg"];setTimeout(t=>{o.downloadImage({node:l.node(),scale:e,isSvg:!1,backgroundColor:i,onAlreadySerialized:t=>{o.update(s)},imageName:r.imageName,onLoad:n,save:a})},t?d+10:0)};0<c?h.each(function(){o.toDataURL(this.src,t=>{this.src=t,++l==c&&g()})}):g()}exportSvg(){var{svg:t,imageName:e}=this.getChartState();return this.downloadImage({imageName:e,node:t.node(),scale:3,isSvg:!0}),this}expandAll(){var t=this.getChartState()["data"];return t.forEach(t=>t._expanded=!0),this.render(),this}collapseAll(){var t=this.getChartState()["allNodes"];return t.forEach(t=>t.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:t,scale:e=2,imageName:n="graph",isSvg:a=!1,save:i=!0,backgroundColor:o="#FAFAFA",onAlreadySerialized:r=t=>{},onLoad:d=t=>{}}){const s=t;function l(t,e){var n=document.createElement("a");"string"==typeof n.download?(document.body.appendChild(n),n.download=e,n.href=t,n.click(),document.body.removeChild(n)):location.replace(t)}function h(t){for(var e="http://www.w3.org/2000/xmlns/",n=(t=t.cloneNode(!0),window.location.href+"#"),a=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,null,!1);a.nextNode();)for(const t of a.currentNode.attributes)t.value.includes(n)&&(t.value=t.value.replace(n,"#"));return t.setAttributeNS(e,"xmlns","http://www.w3.org/2000/svg"),t.setAttributeNS(e,"xmlns:xlink","http://www.w3.org/1999/xlink"),(new XMLSerializer).serializeToString(t)}if(a)t='<?xml version="1.0" standalone="no"?>\r\n'+(t=h(s)),l(c="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(t),n+".svg"),r();else{const t=e,a=document.createElement("img");a.onload=function(){var e=document.createElement("canvas"),r=s.getBoundingClientRect(),h=(e.width=r.width*t,e.height=r.height*t,e.getContext("2d")),h=(h.fillStyle=o,h.fillRect(0,0,r.width*t,r.height*t),h.drawImage(a,0,0,r.width*t,r.height*t),e.toDataURL("image/png"));d&&d(h),i&&l(h,n+".png")};var c="data:image/svg+xml; charset=utf8, "+encodeURIComponent(h(s));r(),a.src=c}}getTextWidth(t,{fontSize:e=14,fontWeight:n=400,defaultFont:a="Helvetice",ctx:i}={}){return i.font=`${n||""} ${e}px ${a} `,i.measureText(t).width}clear(){var t=this.getChartState();d.select(window).on("resize."+t.id,null),t.svg&&t.svg.selectAll("*").remove()}},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=d3-org-chart.js.map